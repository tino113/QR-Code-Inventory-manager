{% extends 'base.html' %}
{% block content %}
<form method="get" class="mb-3">
  <input class="form-control mb-2" type="text" name="q" placeholder="Search" value="{{ request.args.get('q','') }}">
  <div class="row g-2">
    <div class="col"><input class="form-control" type="text" name="name" placeholder="Item name" value="{{ request.args.get('name','') }}"></div>
    <div class="col"><input class="form-control" type="text" name="type" placeholder="Type" value="{{ request.args.get('type','') }}"></div>
    <div class="col"><input class="form-control" type="number" name="quantity" placeholder="Quantity" value="{{ request.args.get('quantity','') }}"></div>
    <div class="col">
      <select class="form-select" name="location">
        <option value="">Location</option>
        {% for loc in all_locations %}
          <option value="{{ loc.id }}" {% if request.args.get('location')==loc.id|string %}selected{% endif %}>{{ loc.full_path() }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col">
      <select class="form-select" name="container">
        <option value="">Container</option>
        {% for c in all_containers %}
          <option value="{{ c.id }}" {% if request.args.get('container')==c.id|string %}selected{% endif %}>{{ c.name or c.code }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-auto"><button class="btn btn-primary" type="submit">Filter</button></div>
  </div>
</form>
<div class="accordion" id="inv-acc">
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingItems">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseItems">Items</button>
    </h2>
    <div id="collapseItems" class="accordion-collapse collapse show">
      <div class="accordion-body p-0">
        <ul class="list-group list-group-flush">
        {% for item in items %}
          <li class="list-group-item">
            <span title="item">üìÑ</span> <a href="/item/{{ item.code }}">{{ item.name }} ({{ item.quantity }}){% if item.hierarchy() %} / {{ item.hierarchy() }}{% endif %}</a>
          </li>
        {% endfor %}
        </ul>
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingContainers">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseContainers">Containers</button>
    </h2>
    <div id="collapseContainers" class="accordion-collapse collapse show">
      <div class="accordion-body p-0">
        <ul class="list-group list-group-flush">
        {% for c in containers %}
          <li class="list-group-item">
            <span title="container">üì¶</span> <a href="/container/{{ c.code }}">{{ c.name or c.code }}{% if c.location %} / {{ c.location.full_path() }}{% endif %}</a>
          </li>
        {% endfor %}
        </ul>
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingLocations">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseLocations">Locations</button>
    </h2>
    <div id="collapseLocations" class="accordion-collapse collapse show">
      <div class="accordion-body p-0">
        <ul class="list-group list-group-flush">
        {% for l in locations %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div><span title="location">üìç</span> <a href="/location/{{ l.code }}">{{ l.full_path() }}</a></div>
          </li>
        {% endfor %}
        </ul>
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingMissing">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseMissing">Missing Items &amp; Containers</button>
    </h2>
    <div id="collapseMissing" class="accordion-collapse collapse show">
      <div class="accordion-body p-0">
        <ul class="list-group list-group-flush">
        {% for item in missing_items %}
          <li class="list-group-item"><a href="/item/{{ item.code }}">{{ item.name }} ({{ item.quantity }})</a></li>
        {% endfor %}
        {% for c in missing_containers %}
          <li class="list-group-item"><a href="/container/{{ c.code }}">Container: {{ c.name }}</a></li>
        {% endfor %}
        </ul>
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingUnacc">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseUnacc">Unaccounted Items</button>
    </h2>
    <div id="collapseUnacc" class="accordion-collapse collapse show">
      <div class="accordion-body p-0">
        <ul class="list-group list-group-flush">
        {% for item in unaccounted %}
          <li class="list-group-item"><a href="/item/{{ item.code }}">{{ item.name }} ({{ item.quantity }})</a></li>
        {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>
{% endblock %}
